/**
 * @file STimer.h
 * @author Michael Meindl
 * @date 24.9.2016
 * @brief Class definition of a timer task which is implemented as a singleton.
 */
#ifndef STIMER_H
#define STIMER_H
#include "IRunnable.h"
#include "CMutex.h"
#include "CCountingSemaphore.h"
#include "Global.h"

class STimer : public IRunnable
{
public:
	/**
	 * Static method to get the singleton instance, may block the calling thread.
	 */
	static STimer& getInstance();
	void run() override;
	void init() override;
	/**
	 * Method to start the timer.
	 */
	bool start();
	/**
	 * Method to stop the timer.
	 */
	bool stop();
public:
	STimer(const STimer&) = delete;
	STimer& operator=(const STimer&) = delete;
	~STimer();
private:
	STimer();
private:
	static STimer* sInstance;
	static CMutex sAccessMutex;
	CCountingSemaphore mRunningSem;
};

#endif
