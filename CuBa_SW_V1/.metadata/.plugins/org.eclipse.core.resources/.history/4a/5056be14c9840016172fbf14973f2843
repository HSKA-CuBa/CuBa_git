#include "CServer.h"
#include <errno.h>
#include <iostream>
#include <cstdlib>
#include <unistd.h>
#include <netinet/in.h>
#include <sys/socket.h>

CServer::CServer() : mSocketFD(-1),
					 mConnectionFD(-1)
{
	mSocketFD = socket(AF_INET, SOCK_STREAM, 0);
	sAssertion(mSocketFD >= 0, "CServer::waitForClient(): Failed to create socket", true);

	mSocketAddr.sin_family	= AF_INET;
	mSocketAddr.sin_port	= htons(40000);
	mSocketAddr.sin_addr 	= INADDR_ANY;
	Int32 retVal = bind(mSocketFD,
						reinterpret_cast<struct sockaddr*>(mSocketAddr),
						sizeof(mSocketAddr));
	sAssertion(retVal >= 0, "CServer::CServer(): Failed to bind the socket", true);

	retVal = listen(mSocketFD, 1);
	sAssertion(retVal >= 0, "CServer::CServer(): Failed to listen", true);
}
bool CServer::waitForClient()
{
	mConnectionFD = accept(mSocketFD,
						   reinterpret_cast<struct sockaddr*>(&mClientAddr),
						   &mClientLen);

}
